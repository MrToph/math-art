"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _taggedTemplateLiteral(a,b){return Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}}))}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function endAll(a,b){var c;a.empty()?b():(c=a.size(),a.each("end",function(){c--,0===c&&b()}))}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var stepper={};jQuery(function(){stepper=new Stepper;var a=new Visualization(jQuery("#canvasContainer").get(0));stepper.registerCallback(1,a.onStep.bind(a));var b=new MathContainer(jQuery("#mathContainer").get(0));stepper.registerCallback(1,b.onStep.bind(b))}),Number.prototype.clamp=function(a,b){return Math.min(Math.max(this,a),b)};var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),ISteppable=function(){function a(){_classCallCheck(this,a),this.maxStep=0}return _createClass(a,[{key:"redraw",value:function(){arguments.length<=0||void 0===arguments[0]?this.currentStep:arguments[0]}},{key:"onStep",value:function(a){var b=this.currentStep;a?b++:b--,b=b.clamp(0,this.maxStep);var c={canBackward:!1,canForward:!1};return b>0&&(c.canBackward=!0),b<this.maxStep&&(c.canForward=!0),b===this.currentStep?c:(this.currentStep=b,this.redraw(this.currentStep),c)}}]),a}(),_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_templateObject=_taggedTemplateLiteral(["definecolor{colorRed}{RGB}{255,50,50}definecolor{colorGreen}{RGB}{50,205,50}\n                                    definecolor{colorBlue}{RGB}{50,50,255}definecolor{colorYellow}{RGB}{255,165,0}"],["\\definecolor{colorRed}{RGB}{255,50,50}\\definecolor{colorGreen}{RGB}{50,205,50}\n                                    \\definecolor{colorBlue}{RGB}{50,50,255}\\definecolor{colorYellow}{RGB}{255,165,0}"]),_templateObject2=_taggedTemplateLiteral(["	extcolor{colorRed}{1^2} + 	extcolor{colorGreen}{2^2} + 	extcolor{colorBlue}{3^2} + 	extcolor{colorYellow}{4^2} + ldots + n^2"],["\\textcolor{colorRed}{1^2} + \\textcolor{colorGreen}{2^2} + \\textcolor{colorBlue}{3^2} + \\textcolor{colorYellow}{4^2} + \\ldots + n^2"]),_templateObject3=_taggedTemplateLiteral(["3 cdot (1^2 + 2^2 + 3^2 + 4^2 + ldots + n^2)"],["3 \\cdot (1^2 + 2^2 + 3^2 + 4^2 + \\ldots + n^2)"]),_templateObject4=_taggedTemplateLiteral(["3 cdot (1^2 + 2^2 + 3^2 + 4^2 + ldots + n^2) =  n (n+1) (n+\frac{1}{2})"],["3 \\cdot (1^2 + 2^2 + 3^2 + 4^2 + \\ldots + n^2) =  n (n+1) (n+\\frac{1}{2})"]),_templateObject5=_taggedTemplateLiteral(["1^2 + 2^2 + 3^2 + 4^2 + ldots + n^2 = \frac{1}{3} n (n+1) (n+\frac{1}{2})"],["1^2 + 2^2 + 3^2 + 4^2 + \\ldots + n^2 = \\frac{1}{3} n (n+1) (n+\\frac{1}{2})"]),MathContainer=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,Object.getPrototypeOf(b).call(this));return c.width=1200,c.height=500,c.currentStep=0,c.element=a,c.maxStep=8,c.oldInnerHTML="",MathJax.Hub.Queue(function(){c.jax=MathJax.Hub.getAllJax("mathContainer")[0]},function(){c.redraw(0)}),c}return _inherits(b,a),_createClass(b,[{key:"redraw",value:function(){var a=(arguments.length<=0||void 0===arguments[0]?this.currentStep:arguments[0],this.getTextForCurrentStep());a!==this.oldInnerHTML&&(this.oldInnerHTML=a,MathJax.Hub.queue.Push(["Text",this.jax,a]))}},{key:"getTextForCurrentStep",value:function(){var a=String.raw(_templateObject),b="";switch(this.currentStep){case 0:b=String.raw(_templateObject2);break;case 1:case 2:case 3:case 4:case 5:case 6:b=String.raw(_templateObject3);break;case 7:case 8:b=String.raw(_templateObject4);break;default:b=String.raw(_templateObject5)}return a+" \\smash{"+b+"}"}}]),b}(ISteppable),_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},Pythagoras=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,Object.getPrototypeOf(b).call(this));return a.svg=null,a.margin={top:-5,right:-5,bottom:-5,left:-5},a.width=1200-a.margin.left-a.margin.right,a.height=500-a.margin.top-a.margin.bottom,a.currentStep=0,a.squareSize=450,a.squareOffset=[{top:25,left:50},{top:25,left:a.width-a.squareSize-50}],a.r=.7*a.squareSize,a.colors=["#ff3232","#32ff32","#3232ff"],a.maxStep=7,a.translate=[0,0],a.scale=1,a}return _inherits(b,a),_createClass(b,[{key:"init",value:function(a){var b=this.width+this.margin.left+this.margin.right,c=this.height+this.margin.top+this.margin.bottom,d=d3.select(a).append("svg").attr("viewBox","0 0 "+b+" "+c).append("g").attr("transform","translate("+this.margin.left+","+this.margin.right+")");this.svg=d;var e=(d.append("rect").attr("x",-this.margin.left).attr("y",-this.margin.top).attr("width",b).attr("height",c),d.append("g").attr("transform","translate("+this.translate[0]+","+this.translate[1]+"),scale("+this.scale+")"));this.createGradient(),this.container=e,this.triangles=e.append("svg:g"),this.squares=e.append("svg:g"),this.texts=e.append("svg:g"),this.dragPoint=e.append("svg:g"),this.redraw(0)}},{key:"getSVG",value:function(){return this.svg}},{key:"toSVGCoordinates",value:function(a){var b=[a[0],a[1]];return b[0]=(b[0]-this.translate[0])/this.scale,b[1]=(b[1]-this.translate[1])/this.scale,b}},{key:"idToPoint",value:function(a){return $.grep(this.points,function(b){return b.id===a})[0]}},{key:"createShapes",value:function(a){switch(a){case 0:this.points=[{id:100,x:0,y:0},{id:101,x:this.r,y:0},{id:102,x:0,y:this.squareSize-this.r},{id:999,x:this.squareOffset[0].left+this.r,y:this.squareOffset[0].top}],this.triangleData=[{a:100,b:101,c:102,pivot:100,translate:100,squareIndex:0,rotation:0}],this.squareData=[],this.dragPointData=[{index:999}],this.textData=[];break;case 1:this.points=[{id:1,x:0,y:0},{id:2,x:this.r,y:0},{id:3,x:this.squareSize,y:this.r},{id:4,x:this.squareSize-this.r,y:this.squareSize},{id:5,x:0,y:this.squareSize-this.r},{id:100,x:0,y:0},{id:101,x:this.r,y:0},{id:102,x:0,y:this.squareSize-this.r},{id:999,x:this.squareOffset[0].left+this.r,y:this.squareOffset[0].top}],this.triangleData=[{a:100,b:101,c:102,pivot:100,translate:1,squareIndex:0,rotation:0},{a:100,b:101,c:102,pivot:102,translate:2,squareIndex:0,rotation:180},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:0,rotation:270},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:0,rotation:360}],this.squareData=[{a:2,b:3,c:4,d:5,squareIndex:0,color:this.colors[0]}],this.dragPointData=[],this.textData=[];break;case 2:this.points=[{id:1,x:0,y:0},{id:2,x:this.r,y:0},{id:3,x:this.squareSize,y:this.r},{id:4,x:this.squareSize-this.r,y:this.squareSize},{id:5,x:0,y:this.squareSize-this.r},{id:100,x:0,y:0},{id:101,x:this.r,y:0},{id:102,x:0,y:this.squareSize-this.r},{id:999,x:this.squareOffset[0].left+this.r,y:this.squareOffset[0].top}],this.triangleData=[{a:100,b:101,c:102,pivot:100,translate:1,squareIndex:0,rotation:0},{a:100,b:101,c:102,pivot:102,translate:2,squareIndex:0,rotation:90},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:0,rotation:180},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:0,rotation:270}],this.squareData=[{a:2,b:3,c:4,d:5,squareIndex:0,color:this.colors[0]}],this.dragPointData=[{index:999}],this.textData=[];break;case 3:this.points=[{id:1,x:0,y:0},{id:2,x:this.r,y:0},{id:3,x:this.squareSize,y:this.r},{id:4,x:this.squareSize-this.r,y:this.squareSize},{id:5,x:0,y:this.squareSize-this.r},{id:100,x:0,y:0},{id:101,x:this.r,y:0},{id:102,x:0,y:this.squareSize-this.r},{id:998,x:(this.squareOffset[0].left+this.squareSize+this.squareOffset[1].left)/2-22,y:this.squareOffset[0].top+this.squareSize/2+43},{id:999,x:this.squareOffset[0].left+this.r,y:this.squareOffset[0].top}],this.triangleData=[{a:100,b:101,c:102,pivot:100,translate:1,squareIndex:0,rotation:0},{a:100,b:101,c:102,pivot:102,translate:2,squareIndex:0,rotation:90},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:0,rotation:180},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:0,rotation:270},{a:100,b:101,c:102,pivot:100,translate:1,squareIndex:1,rotation:0},{a:100,b:101,c:102,pivot:102,translate:2,squareIndex:1,rotation:90},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:1,rotation:180},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:1,rotation:270}],this.squareData=[{a:2,b:3,c:4,d:5,squareIndex:0,color:this.colors[0]},{a:2,b:3,c:4,d:5,squareIndex:1,color:"url(#gradient)"}],this.dragPointData=[{index:999}],this.textData=[{caption:"=",fontSize:"72pt",translate:998}];break;case 4:this.points=[{id:1,x:0,y:0},{id:2,x:this.r,y:0},{id:3,x:this.squareSize,y:this.r},{id:4,x:this.squareSize-this.r,y:this.squareSize},{id:5,x:0,y:this.squareSize-this.r},{id:100,x:0,y:0},{id:101,x:this.r,y:0},{id:102,x:0,y:this.squareSize-this.r},{id:200,x:this.squareSize-this.r,y:0},{id:201,x:this.squareSize,y:0},{id:202,x:this.squareSize-this.r,y:this.r},{id:203,x:this.squareSize,y:this.r},{id:204,x:0,y:this.r},{id:205,x:0,y:this.squareSize},{id:206,x:this.squareSize-this.r,y:this.squareSize},{id:998,x:(this.squareOffset[0].left+this.squareSize+this.squareOffset[1].left)/2-22,y:this.squareOffset[0].top+this.squareSize/2+43},{id:999,x:this.squareOffset[0].left+this.r,y:this.squareOffset[0].top}],this.triangleData=[{a:100,b:101,c:102,pivot:101,translate:2,squareIndex:0,rotation:0},{a:100,b:101,c:102,pivot:102,translate:2,squareIndex:0,rotation:90},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:0,rotation:180},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:0,rotation:270},{a:100,b:101,c:102,pivot:101,translate:2,squareIndex:1,rotation:0,rotationTo:-90,moveTo:1},{a:100,b:101,c:102,pivot:102,translate:2,squareIndex:1,rotation:90,moveTo:1},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:1,rotation:180},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:1,rotation:270,rotationTo:360}],this.squareData=[{a:2,b:3,c:4,d:5,squareIndex:0,color:this.colors[0]},{a:2,b:3,c:4,d:5,squareIndex:1,color:"url(#gradient)"},{a:200,b:201,c:203,d:202,squareIndex:1,color:this.colors[1]},{a:204,b:202,c:206,d:205,squareIndex:1,color:this.colors[2]}],this.dragPointData=[],this.textData=[{caption:"=",fontSize:"72pt",translate:998}];break;case 5:this.points=[{id:1,x:0,y:0},{id:2,x:this.r,y:0},{id:3,x:this.squareSize,y:this.r},{id:4,x:this.squareSize-this.r,y:this.squareSize},{id:5,x:0,y:this.squareSize-this.r},{id:100,x:0,y:0},{id:101,x:this.r,y:0},{id:102,x:0,y:this.squareSize-this.r},{id:200,x:this.squareSize-this.r,y:0},{id:201,x:this.squareSize,y:0},{id:202,x:this.squareSize-this.r,y:this.r},{id:203,x:this.squareSize,y:this.r},{id:204,x:0,y:this.r},{id:205,x:0,y:this.squareSize},{id:206,x:this.squareSize-this.r,y:this.squareSize},{id:998,x:(this.squareOffset[0].left+this.squareSize+this.squareOffset[1].left)/2-22,y:this.squareOffset[0].top+this.squareSize/2+43},{id:999,x:this.squareOffset[0].left+this.r,y:this.squareOffset[0].top}],this.triangleData=[{a:100,b:101,c:102,pivot:101,translate:2,squareIndex:0,rotation:0},{a:100,b:101,c:102,pivot:102,translate:2,squareIndex:0,rotation:90},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:0,rotation:180},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:0,rotation:270},{a:100,b:101,c:102,pivot:101,translate:1,squareIndex:1,rotation:270},{a:100,b:101,c:102,pivot:102,translate:1,squareIndex:1,rotation:90},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:1,rotation:180},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:1,rotation:0}],this.squareData=[{a:2,b:3,c:4,d:5,squareIndex:0,color:this.colors[0]},{a:200,b:201,c:203,d:202,squareIndex:1,color:this.colors[1]},{a:204,b:202,c:206,d:205,squareIndex:1,color:this.colors[2]}],this.dragPointData=[{index:999}],this.textData=[{caption:"=",fontSize:"72pt",translate:998}];break;case 6:this.points=[{id:1,x:0,y:0},{id:2,x:this.r,y:0},{id:3,x:this.squareSize,y:this.r},{id:4,x:this.squareSize-this.r,y:this.squareSize},{id:5,x:0,y:this.squareSize-this.r},{id:100,x:0,y:0},{id:101,x:this.r,y:0},{id:102,x:0,y:this.squareSize-this.r},{id:200,x:this.squareSize-this.r,y:0},{id:201,x:this.squareSize,y:0},{id:202,x:this.squareSize-this.r,y:this.r},{id:203,x:this.squareSize,y:this.r},{id:204,x:0,y:this.r},{id:205,x:0,y:this.squareSize},{id:206,x:this.squareSize-this.r,y:this.squareSize},{id:998,x:(this.squareOffset[0].left+this.squareSize+this.squareOffset[1].left)/2-22,y:this.squareOffset[0].top+this.squareSize/2+43},{id:999,x:this.squareOffset[0].left+this.r,y:this.squareOffset[0].top}],this.triangleData=[{a:100,b:101,c:102,pivot:101,translate:2,squareIndex:0,rotation:0},{a:100,b:101,c:102,pivot:102,translate:2,squareIndex:0,rotation:90},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:0,rotation:180},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:0,rotation:270},{a:100,b:101,c:102,pivot:101,translate:1,squareIndex:1,rotation:270},{a:100,b:101,c:102,pivot:102,translate:1,squareIndex:1,rotation:90},{a:100,b:101,c:102,pivot:102,translate:3,squareIndex:1,rotation:180},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:1,rotation:0}],this.squareData=[{a:2,b:3,c:4,d:5,squareIndex:0,color:this.colors[0]},{a:200,b:201,c:203,d:202,squareIndex:1,color:this.colors[1]},{a:204,b:202,c:206,d:205,squareIndex:1,color:this.colors[2]}],this.dragPointData=[],this.textData=[{caption:"=",fontSize:"72pt",translate:998}];break;case 7:this.points=[{id:1,x:0,y:0},{id:2,x:this.r,y:0},{id:3,x:this.squareSize,y:this.r},{id:4,x:this.squareSize-this.r,y:this.squareSize},{id:5,x:0,y:this.squareSize-this.r},{id:100,x:0,y:0},{id:101,x:this.r,y:0},{id:102,x:0,y:this.squareSize-this.r},{id:200,x:this.squareSize-this.r,y:0},{id:201,x:this.squareSize,y:0},{id:202,x:this.squareSize-this.r,y:this.r},{id:203,x:this.squareSize,y:this.r},{id:204,x:0,y:this.r},{id:205,x:0,y:this.squareSize},{id:206,x:this.squareSize-this.r,y:this.squareSize},{id:998,x:(this.squareOffset[0].left+this.squareSize+this.squareOffset[1].left)/2-22,y:this.squareOffset[0].top+this.squareSize/2+43},{id:999,x:this.squareOffset[0].left+this.r,y:this.squareOffset[0].top}],this.triangleData=[{a:100,b:101,c:102,pivot:101,translate:2,squareIndex:0,rotation:0},{a:100,b:101,c:102,pivot:102,translate:4,squareIndex:1,rotation:0}],this.squareData=[{a:2,b:3,c:4,d:5,squareIndex:0,color:this.colors[0]},{a:200,b:201,c:203,d:202,squareIndex:1,color:this.colors[1]},{a:204,b:202,c:206,d:205,squareIndex:1,color:this.colors[2]}],this.dragPointData=[{index:999}],this.textData=[{caption:"=",fontSize:"72pt",translate:998}]}}},{key:"redraw",value:function(){var a=this,b=arguments.length<=0||void 0===arguments[0]?this.currentStep:arguments[0];this.currentStep=b;var c=this;this.createShapes(b),this.triangles.selectAll(".outerTriangle").remove();var d=this.triangles.selectAll(".outerTriangle").data(this.triangleData),e=d.enter();this.createTriangles(e),d.exit().remove(),this.updateTriangles();var f=d3.behavior.drag().origin(function(a){return c.idToPoint(a.index)}).on("drag",function(a,b){var d=c.squareSize;c.r=(d3.event.x-c.squareOffset[0].left).clamp(0,d),c.redraw()}),g=this.dragPoint.selectAll("circle").data(this.dragPointData);g.attr("cx",function(a){return c.idToPoint(a.index).x}).attr("cy",function(a){return c.idToPoint(a.index).y}),g.enter().append("circle").attr("class","dragpoint").attr("r",10).attr("cx",function(a){return c.idToPoint(a.index).x}).attr("cy",function(a){return c.idToPoint(a.index).y}).call(f),g.exit().remove(),this.squares.selectAll(".square").remove();var h=this.squares.selectAll(".square").data(this.squareData),e=h.enter();this.createSquares(e),h.exit().remove(),this.updateSquares();var i=this.texts.selectAll("text").data(this.textData);if(i.exit().remove(),i.enter().append("text"),this.texts.selectAll("text").attr("transform",function(a){return"translate("+c.idToPoint(a.translate).x+","+c.idToPoint(a.translate).y+")"}).text(function(a){return a.caption}).attr("font-size",function(a){return a.fontSize}),1==b){var j=function(){return function(a,b){var c=d3.interpolate(a.rotation,a.rotation-90);return function(a){return"rotate("+c(a)%360+")"}}},k=1e3,l=2e3;this.squares.selectAll(".square").style("opacity",0).transition().ease("linear").duration(k).delay(function(a,b){return 3*(k+l)}).style("opacity",1).each("end",function(){stepper.onForward()}),this.triangles.selectAll(".outerTriangle").filter(function(a,b){return b>0}).style("opacity",0).transition().ease("linear").duration(k).delay(function(a,b){return b*(k+l)}).style("opacity",1).transition().selectAll(".middleTriangle").ease("linear").duration(l).attrTween("transform",j())}else if(4==b){var k,l,m;!function(){var b=function(){return function(a,b){var c=d3.interpolate(a.rotation,a.rotationTo);return function(a){return"rotate("+c(a)%360+")"}}},d=function(){return function(a,b){var d="translate("+(c.squareOffset[a.squareIndex].left+c.idToPoint(a.translate).x)+","+(c.squareOffset[a.squareIndex].top+c.idToPoint(a.translate).y)+")",e="translate("+(c.squareOffset[a.squareIndex].left+c.idToPoint(a.moveTo).x)+","+(c.squareOffset[a.squareIndex].top+c.idToPoint(a.moveTo).y)+")",f=d3.interpolateString(d,e);return function(a){return f(a)}}};k=1e3,l=2e3,m=2e3,a.squares.selectAll(".square").filter(function(a,b){return b>1&&1===a.squareIndex}).style("opacity",0),a.squares.selectAll(".square").filter(function(a,b){return 1===b}).transition().style("opacity",0).ease("linear").duration(k).each("end",function(){c.triangles.selectAll(".middleTriangle").filter(function(a,b){return 4===b||7===b}).transition().ease("linear").duration(l).delay(function(a,b){return(1-b)*l}).attrTween("transform",b()).call(endAll,function(){c.triangles.selectAll(".outerTriangle").filter(function(a,b){return 4===b||5===b}).transition().ease("linear").duration(m).attrTween("transform",d()).call(endAll,function(){c.squares.selectAll(".square").filter(function(a,b){return b>1&&1===a.squareIndex}).transition().style("opacity",1).ease("linear").duration(k).call(endAll,function(){stepper.onForward()})})})})}()}else if(6==b){var k=2e3;this.triangles.selectAll(".outerTriangle").filter(function(a,b){return 1===b||4===b}).style("opacity",1).transition().ease("linear").duration(k).delay(0).style("opacity",0),this.triangles.selectAll(".outerTriangle").filter(function(a,b){return 2===b||5===b}).style("opacity",1).transition().ease("linear").duration(k).delay(k).style("opacity",0),this.triangles.selectAll(".outerTriangle").filter(function(a,b){return 3===b||6===b}).style("opacity",1).transition().ease("linear").duration(k).delay(2*k).style("opacity",0).call(endAll,function(){stepper.onForward()})}}},{key:"createTriangles",value:function(a){var b=a.append("svg:g").attr("class","outerTriangle"),c=b.append("svg:g").attr("class","middleTriangle");c.append("polygon").attr("class","innerTriangle")}},{key:"createSquares",value:function(a){a.append("polygon").attr("class","square")}},{key:"updateTriangles",value:function(){var a=this,b=this.triangles.selectAll(".outerTriangle").attr("transform",function(b){return"translate("+(a.squareOffset[b.squareIndex].left+a.idToPoint(b.translate).x)+","+(a.squareOffset[b.squareIndex].top+a.idToPoint(b.translate).y)+")"}).style("opacity",1),c=b.selectAll(".middleTriangle").data(function(a){return[a]}).attr("transform",function(a){return"rotate("+a.rotation+")"});c.selectAll(".innerTriangle").data(function(a){return[a]}).attr("points",function(b){return a.idToPoint(b.a).x+" "+a.idToPoint(b.a).y+", "+a.idToPoint(b.b).x+" "+a.idToPoint(b.b).y+", "+a.idToPoint(b.c).x+" "+a.idToPoint(b.c).y}).attr("transform",function(b){return"translate("+-a.idToPoint(b.pivot).x+","+-a.idToPoint(b.pivot).y+")"})}},{key:"updateSquares",value:function(){var a=this;this.squares.selectAll(".square").attr("points",function(b){return a.idToPoint(b.a).x+" "+a.idToPoint(b.a).y+", "+a.idToPoint(b.b).x+" "+a.idToPoint(b.b).y+", "+a.idToPoint(b.c).x+" "+a.idToPoint(b.c).y+", "+a.idToPoint(b.d).x+" "+a.idToPoint(b.d).y}).style("fill",function(a){return a.color}).attr("transform",function(b){return"translate("+a.squareOffset[b.squareIndex].left+","+a.squareOffset[b.squareIndex].top+")"})}},{key:"onStep",value:function(a){return this.container.selectAll(".outerTriangle, .middleTriangle, .innerTriangle, .square").transition(),_get(Object.getPrototypeOf(b.prototype),"onStep",this).call(this,a)}},{key:"createGradient",value:function(){var a=this.svg.append("defs").append("linearGradient").attr("id","gradient").attr("x1","30%").attr("y1","30%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad");a.append("stop").attr("offset","0%").attr("stop-color",this.colors[1]).attr("stop-opacity",1),a.append("stop").attr("offset","100%").attr("stop-color",this.colors[2]).attr("stop-opacity",1)}}]),b}(ISteppable),_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Stepper=function(){function a(){_classCallCheck(this,a),this.currentLayer=1,this.callbacks=[],window.addEventListener("keydown",this.onKeyDown.bind(this),!1)}return _createClass(a,[{key:"onForward",value:function(){var a=arguments.length<=0||void 0===arguments[0]?this.currentLayer:arguments[0];this.currentLayer=a,this.doStep(!0)}},{key:"onBackward",value:function(){var a=arguments.length<=0||void 0===arguments[0]?this.currentLayer:arguments[0];this.currentLayer=a,this.doStep(!1)}},{key:"doStep",value:function(a){for(var b={canBackward:!1,canForward:!1},c=0;c<this.callbacks[this.currentLayer].length;c++)b=this.callbacks[this.currentLayer][c](a);this.disableButtons(this.currentLayer,b)}},{key:"disableButtons",value:function(a,b){document.getElementById("leftBtn"+a).disabled=!b.canBackward,document.getElementById("rightBtn"+a).disabled=!b.canForward}},{key:"registerCallback",value:function(a,b){"undefined"==typeof this.callbacks[a]&&(this.callbacks[a]=[]),this.callbacks[a].push(b),this.disableButtons(a,{canBackward:!1,canForward:!0})}},{key:"onKeyDown",value:function(a){switch(a.keyCode){case 65:case 37:this.onBackward(1);break;case 68:case 39:this.onForward(1)}}}]),a}(),_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_get=function b(a,c,d){null===a&&(a=Function.prototype);var e=Object.getOwnPropertyDescriptor(a,c);if(void 0===e){var f=Object.getPrototypeOf(a);return null===f?void 0:b(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},Visualization=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,Object.getPrototypeOf(b).call(this));return c.squareSize=100,c.colors=["#ff3232","#32CD32","#3232ff","#ffa500"],c.currentStep=0,c.maxStep=8,c.init(a),c}return _inherits(b,a),_createClass(b,[{key:"init",value:function(a){this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer,this.renderer.setClearColor(16777215),this.renderer.setSize(window.innerWidth,window.innerHeight,!1),this.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4);var b=new THREE.Vector3(500,750,500);this.camera.position.set(b.x,b.y,b.z),this.controls=new THREE.OrbitControls(this.camera,a),this.controls.enableZoom=!0,this.controls.enablePan=!0,this.controls.enableDamping=!0,this.controls.dampingFactor=.3,this.controls.keys=[65,83,68],this.controls.addEventListener("change",this.render.bind(this)),a.appendChild(this.renderer.domElement),this.cubeGeometry=new THREE.BoxGeometry(this.squareSize,this.squareSize,this.squareSize),this.materials=[];for(var c=0;c<this.colors.length;c++){var d=new THREE.MeshBasicMaterial({color:this.colors[c],wireframe:!1,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:5});this.materials.push(d)}window.addEventListener("resize",this.onWindowResize.bind(this),!1),this.animate(),this.redraw(0)}},{key:"clearScene",value:function(){for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0])}},{key:"onWindowResize",value:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight,!1),this.render()}},{key:"animate",value:function(){requestAnimationFrame(this.animate.bind(this)),TWEEN.update(),this.controls.update(),this.render()}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"createScene",value:function(a){var b=this,c=this.colors.length*this.squareSize,d=100,e=new THREE.Vector3(-1,0,-1).multiplyScalar((c+d)/2),f=this.colors.length;switch(a){case 0:var g=new THREE.Geometry,h=!1;"undefined"==typeof this.blockGeometry&&(h=!0);for(var i=0;f>i;i++)for(var j=0;i+1>j;j++)for(var k=0;i+1>k;k++){var l=new THREE.Mesh(this.cubeGeometry,this.materials[i]),m=new THREE.Vector3(j*this.squareSize,(f-1-i)*this.squareSize,k*this.squareSize);l.position.set(m.x,m.y,m.z),this.scene.add(l);var n=new THREE.EdgesHelper(l,0);this.scene.add(n),h&&(l.updateMatrix(),g.merge(l.geometry,l.matrix))}h&&(this.blockGeometry=g,this.blockGeometry.center(),this.blockGeometry.mergeVertices());break;case 1:for(var o=3e3,p=0,q=0;3>q;q++){var r=new THREE.Mesh(this.blockGeometry,this.materials[q]),s=void 0;if(0==q)s=new THREE.Vector3(0,0,0);else if(1==q){s=new THREE.Vector3(c+d,0,0);new TWEEN.Tween(r.rotation).to({x:Math.PI/2,z:Math.PI/2},o).delay(p).start()}else{s=new THREE.Vector3(0,0,c+d);new TWEEN.Tween(r.rotation).to({x:-Math.PI/2,y:Math.PI/2},o).delay(p+o).onComplete(function(){stepper.onForward()}).start()}s.add(e),r.position.set(s.x,s.y,s.z),this.scene.add(r);var t=new THREE.EdgesHelper(r,0);this.scene.add(t)}break;case 2:case 3:for(var u=2e3,v=function(f){var g=new THREE.Mesh(b.blockGeometry,b.materials[f]),h=void 0;if(0==f)h=new THREE.Vector3(0,0,0);else if(1==f){if(h=new THREE.Vector3(c+d,0,0),g.rotation.x=Math.PI/2,g.rotation.z=Math.PI/2,3===a){new TWEEN.Tween(h).to(new THREE.Vector3(b.squareSize,0,0),u).onUpdate(function(){var a=h.clone().add(e);g.position.set(a.x,a.y,a.z)}).onComplete(function(){stepper.onForward()}).start()}}else h=new THREE.Vector3(0,0,c+d),g.rotation.x=-Math.PI/2,g.rotation.y=Math.PI/2;h.add(e),g.position.set(h.x,h.y,h.z),b.scene.add(g);var i=new THREE.EdgesHelper(g,0);b.scene.add(i)},w=0;3>w;w++)v(w);break;case 4:case 5:for(var x=2e3,y=function(f){var g=new THREE.Mesh(b.blockGeometry,b.materials[f]),h=void 0;if(0==f)h=new THREE.Vector3(0,0,0);else if(1==f)h=new THREE.Vector3(b.squareSize,0,0),g.rotation.x=Math.PI/2,g.rotation.z=Math.PI/2;else if(h=new THREE.Vector3(0,0,c+d),g.rotation.x=-Math.PI/2,g.rotation.y=Math.PI/2,5===a){var i=new TWEEN.Tween(h).to(new THREE.Vector3(0,b.squareSize,c+d),x/2).onUpdate(function(){var a=h.clone().add(e);g.position.set(a.x,a.y,a.z)}),j=new TWEEN.Tween(h).to(new THREE.Vector3(0,b.squareSize,0),x).onUpdate(function(){var a=h.clone().add(e);g.position.set(a.x,a.y,a.z)}).onComplete(function(){stepper.onForward()});i.chain(j),i.start()}h.add(e),g.position.set(h.x,h.y,h.z),b.scene.add(g);var k=new THREE.EdgesHelper(g,0);b.scene.add(k)},z=0;3>z;z++)y(z);break;case 6:for(var A=0;3>A;A++){var B=new THREE.Mesh(this.blockGeometry,this.materials[A]),C=void 0;0==A?C=new THREE.Vector3(0,0,0):1==A?(C=new THREE.Vector3(this.squareSize,0,0),B.rotation.x=Math.PI/2,B.rotation.z=Math.PI/2):(C=new THREE.Vector3(0,this.squareSize,0),B.rotation.x=-Math.PI/2,B.rotation.y=Math.PI/2),C.add(e),B.position.set(C.x,C.y,C.z),this.scene.add(B);var D=new THREE.EdgesHelper(B,0);this.scene.add(D)}break;case 7:case 8:for(var E=0;2>E;E++){var F=new THREE.Mesh(this.blockGeometry,this.materials[E]),G=void 0;0==E?G=new THREE.Vector3(0,0,0):1==E?(G=new THREE.Vector3(this.squareSize,0,0),F.rotation.x=Math.PI/2,F.rotation.z=Math.PI/2):(G=new THREE.Vector3(0,this.squareSize,0),F.rotation.x=-Math.PI/2,F.rotation.y=Math.PI/2),G.add(e),F.position.set(G.x,G.y,G.z),this.scene.add(F);var H=new THREE.EdgesHelper(F,0);this.scene.add(H)}for(var I=new THREE.Vector3(-f*this.squareSize,-this.squareSize/2,-f*this.squareSize),J=0;f>J;J++)for(var K=0;J+1>K;K++)for(var L=1;J+1>L;L++){var M=new THREE.Mesh(this.cubeGeometry,this.materials[2]),N=new THREE.Vector3(K*this.squareSize,(f-1-L)*this.squareSize,J*this.squareSize);N.add(I),M.position.set(N.x,N.y,N.z),this.scene.add(M);var O=new THREE.EdgesHelper(M,0);this.scene.add(O)}if("undefined"==typeof this.halfBlockGeometry){for(var P=new THREE.BoxGeometry(this.squareSize,this.squareSize/2,this.squareSize),Q=new THREE.Geometry,R=0;f>R;R++)for(var S=0;R+1>S;S++){var T=new THREE.Mesh(P,this.materials[2]),U=new THREE.Vector3(S*this.squareSize,(f-1-.25)*this.squareSize,R*this.squareSize);T.position.set(U.x,U.y,U.z),T.updateMatrix(),Q.merge(T.geometry,T.matrix)}this.halfBlockGeometry=Q,this.halfBlockGeometry.center(),this.halfBlockGeometry.mergeVertices()}for(var V=void 0,W=0;2>W;W++){var X=I.clone().add(new THREE.Vector3(1.5*this.squareSize,(2.75+W/2)*this.squareSize,1.5*this.squareSize)),Y=new THREE.Mesh(this.halfBlockGeometry,this.materials[2]);Y.position.set(X.x,X.y,X.z),this.scene.add(Y);var Z=new THREE.EdgesHelper(Y,0);this.scene.add(Z),1===W&&(V=Y)}if(7===a){var $=2e3,_=1e3,aa=new TWEEN.Tween(V.rotation).to({y:Math.PI},$),ba=new TWEEN.Tween(V.position).to({x:"+"+this.squareSize},_),ca=new TWEEN.Tween(V.position).to({y:"-"+this.squareSize/2},_).onComplete(function(){stepper.onForward()});aa.chain(ba),ba.chain(ca),aa.start()}else{
V.rotation.y=Math.PI;var da=V.position.clone().add(new THREE.Vector3(this.squareSize,-this.squareSize/2,0));V.position.set(da.x,da.y,da.z)}}}},{key:"redraw",value:function(){var a=arguments.length<=0||void 0===arguments[0]?this.currentStep:arguments[0];this.currentStep=a;this.clearScene(),this.createScene(this.currentStep),this.render()}},{key:"onStep",value:function(a){TWEEN.removeAll();var c=_get(Object.getPrototypeOf(b.prototype),"onStep",this).call(this,a);return c}}]),b}(ISteppable);
//# sourceMappingURL=sourceMap.map