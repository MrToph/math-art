{"version":3,"sources":["../js/visualization.jsx"],"names":[],"mappings":"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","file":"visualization-compiled.js","sourcesContent":["class Visualization extends ISteppable{\r\n  constructor(element) {\r\n    super();\r\n    this.svg = null;\r\n    this.margin = {top: -0, right: -0, bottom: -0, left: -0};\r\n    this.width = 1000;\r\n    this.height = 500;\r\n\r\n    this.currentStep = 0;\r\n    this.maxStep = 2;\r\n\r\n    this.translate = [0,0];\r\n    this.scale = 1;\r\n\r\n    let realWidth = this.width + this.margin.left + this.margin.right;\r\n    let realHeight = this.height + this.margin.top + this.margin.bottom;\r\n    let svg = d3.select(element).append(\"svg\")\r\n        .attr(\"viewBox\", \"0 0 \" + realWidth + \" \" + realHeight)\r\n        .append(\"g\")\r\n        .attr(\"transform\", \"translate(\" + this.margin.left + \",\" + this.margin.right + \")\")\r\n\r\n    this.svg = svg;\r\n\r\n    let rect = svg.append(\"rect\")\r\n                .attr(\"class\", \"svgOuterRect\")\r\n                .attr(\"x\", -this.margin.left)\r\n                .attr(\"y\", -this.margin.top)\r\n                .attr(\"width\", realWidth)\r\n                .attr(\"height\", realHeight);\r\n\r\n    let container = svg.append(\"g\")\r\n                      .attr(\"transform\", \"translate(\" + this.translate[0] + \",\" + this.translate[1] + \"),scale(\" + this.scale + \")\");\r\n    this.container = container;\r\n    this.triangles = [this.container.append('g'), this.container.append('g')]\r\n\r\n    // Constants\r\n    this.colors = [\"#ff3232\", \"#3232ff\", \"#32CD32\", \"#ffa500\", \"#8A2BE2\"];\r\n    this.trWidth = 100;\r\n    this.trHeight = this.trWidth;\r\n    this.margin = 2 * this.trWidth;\r\n    this.numCells = 5;\r\n\r\n    this.redraw(0);\r\n  }\r\n  \r\n// http://www.fileformat.info/info/unicode/category/Sm/list.htm\r\n// \\dots = \\u2026   \\vdots = \\u22ee \\ddots = \\u22f0 (/) \\u22f1 (\\)\r\ncreateData(step) {\r\n    switch(step){\r\n        default:{\r\n            this.triangleDrawData = [];\r\n            this.triangleDrawData.push(this.createTriangleData(false));\r\n            this.triangleDrawData.push(this.createTriangleData(true));\r\n        break;\r\n        }\r\n    }\r\n}\r\n\r\n// idToText is a function that maps (row, column) to (text, layer) where layer is from 0 .. this.numCells [-1]\r\n// layer represents the structural layout of the triangle (layer 0: is where the 1's are, layer 1: where the 2's ... layer numCells - 1: where text = n)\r\ncreateTriangleData(upwards){\r\n    let arr = [];\r\n    for(let i = 0; i < this.numCells; i++){\r\n        for(let j = 0; j <= i; j++){\r\n            let jj = upwards ? (this.numCells - 1 - j) : j;\r\n            let ii = upwards ? (this.numCells - 1 - i) : i;\r\n            let xOffset = upwards ? this.numCells * this.trWidth : 0;\r\n            let xPos = jj * this.trWidth + xOffset;\r\n            let yPos = ii * this.trHeight;\r\n            let layer = i;\r\n            arr.push({id: [i,j], width: this.trWidth, height: this.trHeight, layer: layer,\r\n                        x: xPos, y: yPos});\r\n        }\r\n    }\r\n    return arr;\r\n}\r\n\r\nredraw(step = this.currentStep){\r\n    this.currentStep = step;\r\n\r\n    this.createData(step);\r\n    for(let i = 0; i < 2; i++){\r\n        this.createTriangle(step, i);\r\n    }\r\n    if(step === 1){\r\n        let translationDuration = 3000;\r\n        let xOffset = (this.numCells - 1)/2 * this.trWidth;\r\n        this.triangles[0].selectAll('.square').transition().ease('linear')\r\n          .duration(translationDuration).attr(\"x\", d => d.x + xOffset);\r\n\r\n        xOffset = -xOffset;\r\n        this.triangles[1].selectAll('.square').transition().ease('linear')\r\n          .duration(translationDuration).attr(\"x\", d => d.x + xOffset)\r\n          .call(endAll, () => { stepper.onForward() });\r\n    }\r\n}\r\n\r\n  createTriangle(step, index){\r\n    let triangleWidth = this.numCells * this.trWidth;\r\n    this.triangles[index].selectAll(\".square\").remove();\r\n    let squares = this.triangles[index].selectAll(\".square\").data(this.triangleDrawData[index]);\r\n    squares.enter().append('rect').attr('class', 'square');\r\n\r\n    // update\r\n    let xOffset = (step === 2) ? (this.numCells - 1)/2 * this.trWidth : 0;\r\n    xOffset = index === 0 ? xOffset : -xOffset;\r\n    squares = this.triangles[index].selectAll(\".square\")\r\n                .attr('width', d => d.width)\r\n                .attr('height', d => d.height)\r\n                .attr('x', d => d.x + xOffset)\r\n                .attr('y', d => d.y)\r\n                .attr(\"fill\", (d,i) => {\r\n                    if(step === 0)\r\n                        return this.colors[d.layer];\r\n                    else\r\n                        return this.colors[index];\r\n                });\r\n  }\r\n\r\n  onStep(forward){\r\n    // always stop all transitions\r\n    this.container.selectAll('.square').transition();\r\n    return super.onStep(forward);\r\n  }\r\n}\r\n\r\nfunction endAll (transition, callback) {\r\n    var n;\r\n\r\n    if (transition.empty()) {\r\n        callback();\r\n    }\r\n    else {\r\n        n = transition.size();\r\n        transition.each(\"end\", () => {\r\n            n--;\r\n            if (n === 0) {\r\n                callback();\r\n            }\r\n        });\r\n    }\r\n}"]}